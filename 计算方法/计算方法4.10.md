### 计算方法4.10

---

选取不同的点可以使误差变小，如何使误差达到最小：

一共三个公式：

1. **牛顿科茨公式**，等距分布，与原区间一致
   $$
   \int_{-h}^hf(x)dx\approx A_0f(-h)+A_1f(0)+A_2f(h)
   $$

2. 等距分布，与**原区间不**一致
   $$
   \int_{-h}^hf(x)dx\approx A_0f(-h/2)+A_1f(0)+A_2f(h/2)
   $$

3. **不等距分布**，与原区间不一致	
   $$
   \int_{-h}^hf(x)dx\approx A_0f(x_0)+A_1f(x_1)
   $$


具有n+1个节点求积公式，精度最小为n，最大为**2n+1**（此时称为Gauss型求积公式）

---

**Gauss型求积公式**中，考虑的积分变为：
$$
I(f)=\int_a^b\omega(x)f(x)dx
$$
其中$\omega(x)$称为**权函数**

代数精度达到2n+1的**充要条件**：$x_i$为区间[a,b]上关于$\omega(x)$正交的n+1次正交多项式$g_{n+1}(x)$的零点

**证明：**

先证充分性：$Q(f)=\Sigma_{i=0}^{n}A_if(x_i)$求他的代数精度

对任意不超过2n+1次多项式$p_{2n+1}(x)$:$p_{xn+1}(x)=g_{n+1}(x)q_n(x)+r_n(x)$(正交分解)

$R(g_{n+1}(x)q_n(x)+r_n(x))=R(g_{n+1}(x)q_n(x))+R(r_n(x))$

后一项为0，因为有n+1个节点代数精度最小是n，所以$r_n(x)$的误差项是0

则原式$=\int_a^b\omega(x)g_{n+1}(x)q_n(x)dx-\Sigma...=0$

所以代数精度$\geq$2n+1，又由于代数精度为2n+1

必要性由**反证法**易证

---

**引理**：

![image-20200410105155822](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20200410105155822.png)

可以得到求积系数以及截断误差：
$$
A_i=\frac{\gamma_n}{g_{n+1}'(x_i)g_{n}(x_i)}
$$
其中$\gamma_n$是求正交多项式时中间项$(g_n(x),g_n(x))$
$$
R[f]=\frac{\gamma_{n+1}}{(2n+2)!}f^{(2n+2)}(\eta)
$$
随着n的增大，误差以惊人的速度减小

截断误差使用绝招非常方便

此外：Gauss型积分公式的求积系数都应该大于0

---

例:$\int_{-1}^1f(x)dx\approx A_0f(x_0)+A_1f(x_1)$使其具有尽可能高的代数精度

期望代数精度m=3，令$\omega(x)=1$，构造$g_2(x)$

利用正交多项式的递推式，则有：$g_{k+1}(x)=(x-b_k)g_k(x)-c_kg_{k-1}(x)$

取$g_0(x)=1$,然后递推可以得到$g_1(x)=x,g_2(x)=x^2-1/3$

$g_2(x)$零点为$-\sqrt{3}/3,\sqrt{3}/3$，则$Q(f)=A_0f(-\sqrt{3}/3)+A_1f(\sqrt{3}/3)$

然后$A_0=\frac{\gamma_2}{g_2'(x_0)g_1(x_0)}=1,A_1=1$

则$Q(f)=f(-\sqrt{3}/3)+f(\sqrt{3}/3)$

求误差：使用广义皮亚诺定理，取$e(x)=\frac{f^(4)(\psi)}{4!}(x+\sqrt{3}/3)^2(x-\sqrt{3}/3)^2$,然后计算R(e(x))即可

或者使用绝招：令$R(f)=k\cdot f^{(4)}(\psi)=I[f]-Q[f]$,然后把$f(x)=x^4$代入即可

---

**数值微分**：

主要是解决函数经常变化或者不知道函数具体表达式的情况

问题：直接用导数定义来做时违反了浮点数计算的原则（不能除以太小的数），而且也无法估算误差

解决方法：
$$
f'(x_0)\approx\frac{f(x_0+h)-f(x_0)}{h}\\
=A_0f(x_0)+A_1f(x_1)
$$
用函数值的适当组合来计算